{-|
Module : Main
Descrição : Módulo de Haskell referente à quinta tarefa do projeto de LI.
Copyright : Miguel Quaresma <miguelquaresma97@gmail.com>
			João Nogueira
-}
module Main where

import qualified Data.Text as T
import Graphics.Gloss
import GlossExtras

main = do inp <- getContents
          let (x,y) = tarefa5 (readPicture inp)
          putStrLn (show (round x) ++ " " ++ show (round y))

teste :: Picture -> IO()
teste pic = let (x,y) = tarefa5 pic in putStrLn (show (round x) ++ " " ++ show (round y))


tarefa5 :: Picture -> (Float, Float)
tarefa5 pic = medidas pic

medidas :: Picture -> (Float, Float)
medidas pic = (abs((maximum l)-(minimum l)), abs((maximum a)-(minimum a)))
	where
		path = pontosFig pic
		(l, a) = unzip path


-- | Recolhe os pontos principais de uma figura
pontosFig :: Picture -> Path
pontosFig (Blank) = [(0,0)]
pontosFig (Polygon pts) = pts
pontosFig (Line pts) = pts
pontosFig (Circle r) = [(r, 0), (-r, 0), (0, r), (0, -r)]
pontosFig (Bitmap w1 h1 _ _ ) = [(-w / 2, -h / 2), (w / 2, h / 2), (w / 2, -h / 2), (-w / 2, h / 2)]
	where
		w = fromIntegral w1
		h = fromIntegral h1
pontosFig (Color _ pic) = pontosFig pic
pontosFig (Translate x y pic) = zip (map (+ x) x1) (map (+ y) y1)
	where
		(x1,y1) = unzip (pontosFig pic)
pontosFig (Rotate a pic) = rotatePts a (pontosFig pic)
pontosFig (Scale x y pic) = zip (map (* x) x1) (map (* y) y1)
	where
		(x1,y1) = unzip (pontosFig pic)
pontosFig (Pictures []) = []
pontosFig (Pictures (h:t)) = (pontosFig h) ++ pontosFig (Pictures t)
pontosFig _ = []


-- | Devolve os pontos após um rotação de x graus
rotatePts :: Float -> Path -> Path
rotatePts _ [] = []
rotatePts a (h:t) = (rotatePt ar h) : rotatePts a t
	where
		ar = (a*pi)/180
		rotatePt :: Float -> (Float, Float) -> (Float, Float)
		rotatePt a (x, y) = ((x*(cos (-a))-y*(sin (-a)),x*(sin (-a))+y*(cos (-a))))
